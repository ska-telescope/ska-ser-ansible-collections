---
debug: false

# docker_hub_mirror: "http://192.168.99.204:9082"  # default to STFC Nexus Cache

docker_hub_mirror: "http://10.165.4.6:9082"  # Mid ITF Cache
central_nexus_mirror: "http://10.165.4.6:9084"  # Mid ITF Nexus Cache
gitlab_nexus_mirror: "http://10.165.4.6:9085"  # Mid ITF Nexus Cache
nexus_hosted_cache_url: "http://10.165.4.6:9080" # Mid ITF Nexus Cache (docker-internal)
nexus_hosted_cache: "10.165.4.6:9080"

crictl_version: v1.24.2

debian_arch: "{{ {'x86_64': 'amd64', 'aarch64': 'arm64'}[ansible_architecture] | default(ansible_architecture) }}"

containerd_deb_dependencies:
  - apt-transport-https
  - ca-certificates
  - curl
  - software-properties-common
  - gnupg-agent
  - python3-pip

capi_containerd_version: 1.6.6-1

capi_containerd_sysctls:
  # These are recommended in the Kubernetes docs:
  # https://kubernetes.io/docs/setup/production-environment/container-runtimes/#forwarding-ipv4-and-letting-iptables-see-bridged-traffic
  # Required by kube-proxy (in iptables mode? (possibly not in IPVS mode?))
  net.ipv4.ip_forward: "1"
  net.bridge.bridge-nf-call-iptables: "1"
  net.bridge.bridge-nf-call-ip6tables: "1"

  # This isn't in k8s docs, but lumped in with the other bridge-nf-call-* parameters
  # https://wiki.libvirt.org/Net.bridge.bridge-nf-call_and_sysctl.conf.html
  net.bridge.bridge-nf-call-arptables: "1"

  # We think these are for podman (when do we exceed the defaults? What are they?)
  # There exist also fs.inotify.max_user_instances and user.max_inotify_watches.
  # Should we be using one or the other or both? Why these values?
  user.max_inotify_instances: "1048576"
  fs.inotify.max_user_watches: "1048576"

  # Suggested in the Calico troubleshooting guide:
  # https://docs.tigera.io/calico/latest/operations/troubleshoot/troubleshooting#linux-conntrack-table-is-out-of-space
  net.netfilter.nf_conntrack_max: "1000000"

  # Why do we set this? The default Kubernetes service port range is 30000-32767,
  # and the default value for this parameter is "32768 60999" which doesn't overlap.
  net.ipv4.ip_local_port_range: "40000 65535"

capi_containerd_sysctls_override: {}
