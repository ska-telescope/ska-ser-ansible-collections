---
- name: Get Cluster resource
  kubernetes.core.k8s_info:
    api_version: cluster.x-k8s.io/v1beta1
    kind: Cluster
    namespace: "{{ capi_kube_namespace }}"
    name: "{{ capi_cluster }}"
  register: cluster_result

- name: Delete Cluster resource
  kubernetes.core.k8s:
    api_version: cluster.x-k8s.io/v1beta1
    kind: Cluster
    namespace: "{{ capi_kube_namespace }}"
    name: "{{ capi_cluster }}"
    state: absent
    wait: true
  when: cluster_result.resources
