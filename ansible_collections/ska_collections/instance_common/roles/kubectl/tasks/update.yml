
- name: Ensure target directory
  ansible.builtin.file:
    path: '{{ common_server_kubectl_install_dir }}'
    state: directory
    mode: '0755'

- name: Download kubectl
  become: true
  ansible.builtin.get_url:
    url: '{{ common_server_kubectl_url }}'
    dest: '{{ common_server_kubectl_install_dir }}/{{ common_server_kubectl_name }}-{{ common_server_kubectl_version }}'
    mode: 0755

- name: Link installed kubectl # noqa ignore-errors
  become: true
  ignore_errors: true
  ansible.builtin.file:
    src: '{{ common_server_kubectl_install_dir }}/{{ common_server_kubectl_name }}-{{ common_server_kubectl_version }}'
    dest: '{{ common_server_kubectl_install_dir }}/{{ common_server_kubectl_name }}'
    state: link
    mode: 0755
