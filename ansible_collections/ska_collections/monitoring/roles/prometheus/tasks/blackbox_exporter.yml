---
- name: Pull blackbox exporter image {{ prometheus_blackbox_exporter_docker_tags }}
  community.docker.docker_image:
    name: prom/blackbox-exporter
    tag: "{{ prometheus_blackbox_exporter_docker_tags }}"
    source: pull

- name: Stop blackbox exporter container
  community.docker.docker_container:
    name: blackbox-exporter
    state: absent

- name: Start blackbox exporter container
  community.docker.docker_container:
    name: blackbox-exporter
    image: "prom/blackbox-exporter:{{ prometheus_blackbox_exporter_docker_tags }}"
    state: started
    user: root
    restart: true
    restart_policy: always
    ports:
      - "9115:9115"
    volumes:
      - "/etc/hosts:/etc/hosts:ro"
